
mount -t tmpfs none /mnt

mkdir -p /mnt/{boot,nix,etc/nixos,var/log}

mount /dev/disk/by-label/NIXBOOT /mnt/boot
mount /dev/disk/by-label/NIXROOT /mnt/nix

mkdir -p /mnt/nix/persist/{etc/nixos,var/log}

mount -o bind /mnt/nix/persist/etc/nixos /mnt/etc/nixos
mount -o bind /mnt/nix/persist/var/log /mnt/var/log

cd /mnt/etc
nix-shell -p git --run "
git clone https://github.com/tnichols217/nixos-config/ nixos
"

cd /mnt
nixos-install --show-trace